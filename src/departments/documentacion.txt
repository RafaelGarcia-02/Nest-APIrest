ðŸ“˜ 1. El concepto clave: Prisma Client

Prisma Client es una librerÃ­a auto-generada, tipada y basada en el modelo de datos definido en schema.prisma.

Cuando ejecutas:

npx prisma generate


Prisma crea un cliente con mÃ©todos como:

findMany

findFirst

findUnique

create

update

delete

count

aggregate

groupBy

y otros

Cada modelo de la base de datos se convierte en un objeto con estos mÃ©todos.

ðŸ“˜ 2. Tipos de consultas en Prisma
âœ” 2.1 Consultas de lectura (Read)

Estas son las operaciones principales:

findMany()

Trae muchos registros (con filtros opcionales).

prisma.user.findMany();

findUnique()

Trae un solo registro usando un campo Ãºnico (@id o @unique).

prisma.user.findUnique({
  where: { id: 1 }
});

findFirst()

Trae el primer registro que cumpla condiciones (incluso si no son Ãºnicas).

prisma.user.findFirst({
  where: { name: "Juan" }
});

count()

Cuenta registros.

prisma.user.count();

aggregate()

Operaciones matemÃ¡ticas (sum, avg, max, minâ€¦)

prisma.order.aggregate({
  _sum: { total: true }
});

groupBy()

AgrupaciÃ³n estilo SQL.

prisma.order.groupBy({
  by: ["status"],
  _count: true
});

ðŸ“˜ 3. El objeto WHERE (filtros)

El corazÃ³n de Prisma es el objeto where.

Ejemplo bÃ¡sico:

where: {
  age: { gt: 18 }
}

âœ” 3.1 Operadores de comparaciÃ³n
Operador	Significado
equals	igual a
gt	mayor que
gte	mayor o igual
lt	menor que
lte	menor o igual
not	no igual
âœ” 3.2 Operadores para texto
Operador	Significado
contains	contiene
startsWith	empieza con
endsWith	termina con
mode: "insensitive"	case-insensitive

Ejemplo:

where: {
  name: { contains: "juan", mode: "insensitive" }
}

âœ” 3.3 Operadores lÃ³gicos
Operador	Significado
AND	todas las condiciones
OR	al menos una
NOT	negaciÃ³n
where: {
  AND: [
    { age: { gt: 18 } },
    { role: "ADMIN" }
  ]
}

âœ” 3.4 Operadores para listas
Operador	Significado
in	en la lista
notIn	no en la lista
ðŸ“˜ 4. Relaciones (multitabla)

Prisma maneja relaciones con:

include

select

filtros dentro de relaciones

include

Trae datos de tablas relacionadas (JOIN implÃ­cito):

prisma.department.findUnique({
  where: { id: 1 },
  include: { employees: true }
});

select

Permite elegir columnas especÃ­ficas:

select: {
  id: true,
  name: true,
  employees: {
    select: {
      name: true
    }
  }
}

âœ” Filtros dentro de relaciones
include: {
  employees: {
    where: { name: { startsWith: "J" } }
  }
}

âœ” Operadores relacionales
Operador	Significado
some	al menos uno cumple
every	todos cumplen
none	ninguno cumple

Ejemplo:

where: {
  employees: {
    some: { login: { contains: "admin" } }
  }
}

ðŸ“˜ 5. PaginaciÃ³n

Prisma soporta paginaciÃ³n clÃ¡sica:

skip â†’ cuÃ¡ntos saltar

take â†’ cuÃ¡ntos traer

prisma.user.findMany({
  skip: 20,
  take: 10
});

ðŸ“˜ 6. Ordenamiento
orderBy: {
  name: "asc"
}


Ordenar por mÃºltiples criterios:

orderBy: [
  { age: "desc" },
  { name: "asc" }
]

ðŸ“˜ 7. Mutaciones (Create, Update, Delete)
âœ” create
prisma.user.create({
  data: {
    name: "Juan",
    department: {
      connect: { id: 1 }
    }
  }
});

âœ” update
prisma.user.update({
  where: { id: 1 },
  data: { name: "Nuevo" }
});

âœ” deleteMany con condiciones
deleteMany({
  where: { id: { gt: 3 } }
});

ðŸ“˜ 8. Conexiones entre tablas

Prisma permite:

connect

create

disconnect

delete

set

Ejemplo: crear empleado con departamento asociado:

data: {
  name: "Juan",
  department: {
    connect: { id: 2 }
  }
}

ðŸ“˜ 9. Consultas RAW (SQL directo)

A veces necesitas algo que Prisma no permite.

$queryRaw â†’ select

$executeRaw â†’ insert/update/delete

Ejemplo:

await prisma.$executeRaw`ALTER TABLE User AUTO_INCREMENT = 1`;

ðŸ“˜ 10. Transacciones

Prisma soporta transacciones:

âœ” TransacciÃ³n automÃ¡tica
await prisma.$transaction([
  prisma.user.create(...),
  prisma.order.create(...)
]);

âœ” TransacciÃ³n interactiva
await prisma.$transaction(async (tx) => {
  await tx.user.create(...);
  await tx.order.create(...);
});

ðŸ“˜ 11. Buenas prÃ¡cticas

âœ” Siempre filtrar datos sensibles con DTO
âœ” Usar include solo cuando sea necesario
âœ” Evitar select *
âœ” Usar transacciones para operaciones crÃ­ticas
âœ” Usar raw SQL solo como Ãºltimo recurso

ðŸ“˜ 12. Diferencias clave con ORMs tradicionales
Prisma	Hibernate / TypeORM / JPA
Consultas con objetos	Consultas con mÃ©todos o JPQL
No usa SQL manual por defecto	SÃ­ usa SQL o JPQL
Cliente generado	ORM clÃ¡sico
Relaciones se manejan con include/select	JOIN explÃ­cito